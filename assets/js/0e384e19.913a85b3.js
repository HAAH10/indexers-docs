"use strict";(self.webpackChunknear_lake_dock=self.webpackChunknear_lake_dock||[]).push([[671],{3905:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return u}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=n.createContext({}),l=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=l(a),u=r,m=p["".concat(c,".").concat(u)]||p[u]||h[u]||o;return a?n.createElement(m,i(i({ref:t},d),{},{components:a})):n.createElement(m,i({ref:t},d))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=a[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},9881:function(e,t,a){a.r(t),a.d(t,{assets:function(){return d},contentTitle:function(){return c},default:function(){return u},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return h}});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),i=["components"],s={sidebar_position:1},c="Indexers Doc",l={unversionedId:"intro",id:"intro",title:"Indexers Doc",description:"Welcome to the Indexers Doc. Here you will find everything you might need about indexers.",source:"@site/docs/intro.md",sourceDirName:".",slug:"/intro",permalink:"/near-lake-dock/docs/intro",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/intro.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",next:{title:"Overview",permalink:"/near-lake-dock/docs/projects/overview"}},d={},h=[{value:"What is indexer?",id:"what-is-indexer",level:2},{value:"Blockchains and it&#39;s nature",id:"blockchains-and-its-nature",level:3},{value:"Getting the data from a blockchain from the outer world",id:"getting-the-data-from-a-blockchain-from-the-outer-world",level:3},{value:"Indexer",id:"indexer",level:3},{value:"Indexers and &quot;wide&quot; queries",id:"indexers-and-wide-queries",level:2},{value:"Summary",id:"summary",level:2},{value:"What&#39;s next?",id:"whats-next",level:2}],p={toc:h};function u(e){var t=e.components,s=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"indexers-doc"},"Indexers Doc"),(0,o.kt)("p",null,"Welcome to the Indexers Doc. Here you will find everything you might need about indexers."),(0,o.kt)("p",null,"In order to help everyone to understand the concept of indexer and to provide you with all the inputs so you can build your own indexer."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Disclaimer")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Explanation on this page assumes you have a certain level of understanding of the blockhains."))),(0,o.kt)("h2",{id:"what-is-indexer"},"What is indexer?"),(0,o.kt)("h3",{id:"blockchains-and-its-nature"},"Blockchains and it's nature"),(0,o.kt)("p",null,"Blockchain data is optimized for serialized ",(0,o.kt)("strong",{parentName:"p"},"writes"),', one block at a time, as the chain is being created. Querying the blockchain for data about a specific block or account is a fairly straightforward or "narrow" query. However, querying data across many blocks can be cumbersome because we have to aggregate results from multiple single-block queries. We can consider these ',(0,o.kt)("em",{parentName:"p"},'"wide" queries'),"."),(0,o.kt)("p",null,'Giving the fact that a blockchain itself is a database and smart-contract (decentralized application, dApp) is an application that runs on a virtual machine inside a blockchain, we need to understand that smart-contract should be considered as a "backend". While some applications might consist only of smart-contract, in most cases it is not even possible.'),(0,o.kt)("p",null,'Smart-contracts are limited in terms of interactions. By "interactions" we mean things that became very common in the real-world, like user notifications, integration with third-party applications, etc.'),(0,o.kt)("p",null,"However, the nature of a blockchain is that it must be deterministic. The feature of a blockchain that it knows about the state at a given time, and for blockchains the time is a block. Think of it as about snapshots. A blockchain does snapshots of it's state on every block. We as users can call smart-contract for a specific block, and a blockchain guarantees us to be executed with the same result for the same block any time we call it."),(0,o.kt)("p",null,"The deterministic nature of a blockchain closes it from outer world variables. It is totally impossible to perform a call to some API from within a smart-contract. A blockchain and a smart-contract are closed from outer world"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Blockchain closed from outer world",src:a(12).Z,width:"567",height:"500"})),(0,o.kt)("p",null,"Blockchains are great at providing a way to apply the requested changes to the state in a decentralized manner. However, in order to observe the changes, you need to actively pull the information from the network."),(0,o.kt)("p",null,"Instead of abstractive explanations let's look at the example."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Example dApp")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Say, we have a smart-contract that is selling e-books. Once a user bought a book we want to send him a copy via email."))),(0,o.kt)("p",null,"The dApp has a helper deployed somewhere off-chain, and this helper has a code that can send an email with a copy of an e-book. But would we trigger the helper?"),(0,o.kt)("h3",{id:"getting-the-data-from-a-blockchain-from-the-outer-world"},"Getting the data from a blockchain from the outer world"),(0,o.kt)("p",null,"NEAR blockchain implements a ",(0,o.kt)("a",{parentName:"p",href:"https://docs.near.org/docs/api/rpc"},"JSON-RPC endpoint")," for everyone to interact with the blockchain. Throught the JSON-RPC API users can call smart-contracts triggering them to be executed with a given parameters. Also, users can view the data from the blockchain."),(0,o.kt)("p",null,"So, continuing with our example we can make our helper to pull a ",(0,o.kt)("a",{parentName:"p",href:"https://docs.near.org/docs/api/rpc/block-chunk#block"},"Block")," every second, then pull all the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.near.org/docs/api/rpc/block-chunk#chunk"},"Chunks"),' and analyze the Transactions included in the Block to check if there is a transaction to our smart-contract with "buy an e-book" function call. If we observe such a Transaction we need to ensure it is successful to prevent sending the e-book to the user if the "buy e-book" Transaction has failed.'),(0,o.kt)("p",null,"After all this action we can trigger the helper's code to send user an email with the e-book they bought."),(0,o.kt)("p",null,"This approach is so called ",(0,o.kt)("em",{parentName:"p"},"pull model")," of getting the data. There is nothing wrong with this approach, sometimes you might find it as not the most comfortable or reliable approach though."),(0,o.kt)("p",null,"Also, not all the data is available through the JSON-RPC. ",(0,o.kt)("em",{parentName:"p"},"Local Receipts")," for example are not available through the JSON-RPC, because they are not stored in the NEAR node internal database."),(0,o.kt)("h3",{id:"indexer"},"Indexer"),(0,o.kt)("p",null,"A blockchain indexer is an implementation of the ",(0,o.kt)("em",{parentName:"p"},"push model")," of getting the data. Instead of actively pulling the data from the source, your helper waits for the data to be sent to it. The data is as full as it could be and the helper can start analyzing it immediately, and ideally the data is full enough to avoid any additional pulling any details."),(0,o.kt)("p",null,"Getting back to our example, the helper becomes ",(0,o.kt)("strong",{parentName:"p"},"an indexer")," that receives every ",(0,o.kt)("em",{parentName:"p"},"Block")," along with ",(0,o.kt)("strong",{parentName:"p"},"Chunks"),", ",(0,o.kt)("strong",{parentName:"p"},"Transactions")," with its statuses, etc. In the same way the helper analyzes the data and triggers the code to send user an email with the e-book they bought."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Indexer is streaming the data from the blockchain",src:a(929).Z,width:"643",height:"500"})),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"An indexer concept")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"An indexer listens to the ",(0,o.kt)("em",{parentName:"p"},"stream of data as it's being written on chain")," and can then be immediately filtered and processed to detect interesting events or patterns."))),(0,o.kt)("h2",{id:"indexers-and-wide-queries"},'Indexers and "wide" queries'),(0,o.kt)("p",null,"The term ",(0,o.kt)("em",{parentName:"p"},'"wide" queries')," was mentioned in the beginning of this document. Here's a recap:"),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),'"Wide" queries definition')),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"To query data across many blocks requires the aggregation of results from multiple single-block queries. We can consider these ",(0,o.kt)("em",{parentName:"p"},'"wide" queries'),"."))),(0,o.kt)("p",null,"Because indexers listen to the ",(0,o.kt)("em",{parentName:"p"},"stream of data"),' from the blockchain and the data can be immediately filtered and processed according the defined requirements, they can be used to simplify the "wide" queries execution. For example, this stream of data can then be written to a permanent database for later data analysis using a convenient query language like SQL. That is what ',(0,o.kt)("a",{parentName:"p",href:"/near-lake-dock/docs/projects/near-indexer-for-explorer"},"Indexer for Explorer")," is doing."),(0,o.kt)("p",null,'Another example that highlights the need for a "wide query" is when you use a seed phrase to recover one or more accounts. Since a seed phrase essentially represents a signing key pair, the recovery is for all accounts that share the associated public key. Therefore, when a seed phrase is used to recover an account via ',(0,o.kt)("a",{parentName:"p",href:"https://wallet.near.org"},"NEAR Wallet"),", the query requires that all accounts with a matching public key are found and recovered. ",(0,o.kt)("a",{parentName:"p",href:"/near-lake-dock/docs/projects/near-indexer-for-explorer"},"NEAR Indexer for Explorer")," is storing this data to permanent database and this allows ",(0,o.kt)("a",{parentName:"p",href:"https://wallet.near.org"},"NEAR Wallet"),' to perform such "wide queries". This is impossible to achieve using JSON-RPC only.'),(0,o.kt)("h2",{id:"summary"},"Summary"),(0,o.kt)("p",null,"We hope this article gives you an understanding of an indexer concept. Also, we hope now you can easily decide whether you need an indexer for your application."),(0,o.kt)("h2",{id:"whats-next"},"What's next?"),(0,o.kt)("p",null,"We encourage you to learn more about the ",(0,o.kt)("a",{parentName:"p",href:"/near-lake-dock/docs/projects/overview"},"indexer projects"),". Please, proceed to ",(0,o.kt)("a",{parentName:"p",href:"/tutorials/intro"},"Tutorials")," section to learn how to build an indexer on practise."))}u.isMDXComponent=!0},12:function(e,t,a){t.Z=a.p+"assets/images/blockchain-d3723a544eac4f445064a447a9fc6081.png"},929:function(e,t,a){t.Z=a.p+"assets/images/indexer-1cd9943b368c83d82aaeec26876bea7b.png"}}]);